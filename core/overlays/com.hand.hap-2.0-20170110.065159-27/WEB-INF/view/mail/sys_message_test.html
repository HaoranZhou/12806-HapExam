<#-- 
 * description: 邮件发送测试
 * version: 2.0
 * author:jialong.zuo@hand-china.com
 * #{copyright}#
 * 
-->

<#include "../include/header.html">
<body>
<script src="http://cdn.bootcss.com/bootstrap/3.3.0/js/bootstrap.min.js"></script>
<script>
    viewModel = new kendo.observable({
        model: {}
    });
</script>

<div class="col-sm-12" style="margin-top: 10px;">
    <ul class="nav nav-tabs" id="mytab">
        <li class="active"><a href="#maintain" data-toggle="tab"><@spring.message "message.templatetest"/></a></li>
        <li class=""><a href="#minortain" data-toggle="tab"><@spring.message "message.customtest"/></a></li>
    </ul>
    <div id="tabContent" class="tab-content">
        <div class="tab-pane fade in active" style="margin-top: 10px;" id="maintain">
            <div style="padding:15px 15px 0">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel">
                            <form class="form-horizontal" id="form-query" style="width:100%">
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label class="col-sm-5 control-label"><@spring.message "messageemailconfig.accountcode"/>
                                            :</label>
                                        <div class="col-sm-4">
                                            <input id="accountCode" type=text data-bind="value:model.accountCode"
                                                   style="width:50%"
                                                   required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                        </div>
                                        <script>
                                            $("#accountCode").kendoLov($.extend(${lovProvider.getLov(base.contextPath, base.locale, "MESSAGE_ACCOUNT")}, {}))
                                        </script>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-5 control-label"><@spring.message "message.receivers"/>
                                            :</label>
                                        <div class="col-sm-4">
                                            <input id="receivers" type="text" data-bind="value:model.receivers"
                                                   style="width:50%"
                                                   class="k-textbox" required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-5 control-label"><@spring.message "messagetemplate.templatecode"/>
                                            :</label>
                                        <div class="col-sm-4">
                                            <input id="templateCode" type=text data-bind="value:model.templateCode"
                                                   style="width:50%"
                                                   required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                        </div>
                                        <script>
                                            $("#templateCode").kendoLov($.extend(${lovProvider.getLov(base.contextPath, base.locale, "MESSAGE_TEMPLATE")}, {}))
                                        </script>
                                    </div>
                                <#--                        <div class="form-group">
                                                            <label class="col-sm-4 control-label"><@spring.message "message.subject"/>
                                                                :</label>
                                                            <div class="col-sm-4">
                                                                <input id="subject" type="text" data-bind="value:model.subject"
                                                                       style="width:50%" class="k-textbox" />
                                                            </div>
                                                        </div>
                                                        <div class="form-group">
                                                            <label class="col-sm-4 control-label"><@spring.message "message.content"/>:</label>
                                                            <div class="col-sm-4">
                                                                <input id="content" type="text" data-bind="value:model.content" style="width:50%"
                                                                       class="k-textbox"  required validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                                            </div>
                                                        </div>-->
                                </div>
                                <div class="panel-footer text-center" id="toolbar">
                        <span class="btn btn-success"
                              onclick="submitform('template')"><@spring.message "hap.submit"/></span>
                                </div>
                            </form>
                            <script>kendo.bind($('#form-query'), viewModel);</script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="minortain" class="tab-pane fade">
            <div style="padding:15px 15px 0">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="panel">
                            <form class="form-horizontal" id="form-query1" style="width:100%">
                                <div class="panel-body">
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label"><@spring.message "messageemailconfig.accountcode"/>
                                            :</label>
                                        <div class="col-sm-7">
                                            <input id="accountCode1" type=text data-bind="value:model.accountCode"
                                                   style="width:50%"
                                                   required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                        </div>
                                        <script>
                                            $("#accountCode1").kendoLov($.extend(${lovProvider.getLov(base.contextPath, base.locale, "MESSAGE_ACCOUNT")}, {}))
                                        </script>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label"><@spring.message "message.receivers"/>
                                            :</label>
                                        <div class="col-sm-7">
                                            <input id="receivers1" type="text" data-bind="value:model.receivers"
                                                   style="width:50%"
                                                   class="k-textbox" required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label"><@spring.message "message.subject"/>
                                            :</label>
                                        <div class="col-sm-7">
                                            <input id="subject" type="text" data-bind="value:model.subject"
                                                   style="width:50%" class="k-textbox"/>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label class="col-sm-4 control-label"><@spring.message "message.content"/>
                                            :</label>
                                        <div class="col-sm-7">
                                            <textarea id="content" type="text" data-bind="value:model.content"
                                                   style="width:50%;height: 200px" required
                                                   validationMessage="<@spring.message "hap.validation.notempty"/>"></textarea>
                                        </div>
                                    </div>
                                    <div class="panel-footer text-center" id="toolbar1">
                        <span class="btn btn-success"
                              onclick="submitform('custom')"><@spring.message "hap.submit"/></span>
                                    </div>
                            </form>
                            <script>kendo.bind($('#form-query1'), viewModel);</script>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script type="text/javascript">

    function submitform(mode) {
        viewModel.model.set("mode",mode);
        $.ajax({
            url: '${base.contextPath}/sys/message/sendTest',
            type: "POST",
            dataType: "json",
            contentType: "application/json",
            data: kendo.stringify(viewModel.model),
            success: function (args) {
                if (args.success) {
                    alert('send success');
                }
            }
        });
    }


</script>
</body>
</html>